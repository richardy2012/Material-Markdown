<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../settings-routes.html">
<link rel="import" href="../io-behavior/io-behavior.html">

<dom-module id="app-settings">

  <style>
    :host {
      display: block;
    }

    .menubar{
      -webkit-app-region: drag;
      -webkit-user-select: none;
      border-radius: 0;
    }
    .small-icon {
      --iron-icon-height: 18px;
      --iron-icon-width: 18px;
      padding: 0;
      margin: 0;
      -webkit-app-region: no-drag;
    }
    paper-menu iron-icon {
      margin-right: 33px;
      opacity: 0.54;
    }
    paper-menu a {
      text-decoration: none;
      display: -ms-flexbox;
      display: -webkit-flex;
      display: flex;
      -ms-flex-direction: row;
      -webkit-flex-direction: row;
      flex-direction: row;
      -ms-flex-align: center;
      -webkit-align-items: center;
      align-items: center;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      line-height: 24px;
      min-height: 48px;
      padding: 0 16px;
    }
    paper-card {
      max-width: 640px;
      margin: 16px;
    }
    paper-card img{
      padding: 15px;
    }
    .option{
      padding: 3px;
    }
    paper-toggle-button{
      --paper-toggle-button-checked-bar-color:  #E91E63;
      --paper-toggle-button-checked-button-color:  #E91E63;
      --paper-toggle-button-checked-ink-color: #E91E63;
      /*--paper-toggle-button-unchecked-bar-color:  ;*/
      /*--paper-toggle-button-unchecked-button-color:  ;*/
      /*--paper-toggle-button-unchecked-ink-color: ;*/
    }
    paper-card{
      --paper-card-content{
        background: #e5e5e5;
      }
    }

  </style>

  <template id="settings">

    <div class = "layout horizontal start menubar" style = "height: 20px; width = 100%; background: #2196F3;">
      <paper-icon-button class="small-icon" icon="close" id = "settings-close"></paper-icon-button>
      <paper-icon-button class="small-icon" icon="remove" id = "settings-minimize"></paper-icon-button>
      <paper-icon-button class="small-icon" icon="fullscreen" id = "settings-fullscreen"></paper-icon-button>
    </div>

    <paper-drawer-panel id="drawerPanel" responsive-width="600px" style = 'top: 20px; height: calc(100% - 20px)'>

        <div class="nav" drawer fixed>
          <paper-header-panel>
            <paper-toolbar>
              <div class="title">Settings</div>
            </paper-toolbar>
            <paper-menu>

              <a data-route="settings" href="/">
                <iron-icon icon="settings"></iron-icon>
                <span>General</span>
              </a>

              <a data-route="editor" href="/editor">
                <iron-icon icon="create"></iron-icon>
                <span>Editor</span>
              </a>

              <a data-route="markdown" href="/markdown">
                <iron-icon icon="extension"></iron-icon>
                <span>Markdown</span>
              </a>

              <a data-route="theming" href="/theming">
                <iron-icon icon="invert-colors"></iron-icon>
                <span>Theming</span>
              </a>

              <a data-route="outputStyles" href="/outputStyles">
                <iron-icon icon="image:color-lens"></iron-icon>
                <span>Output Styles</span>
              </a>
            </paper-menu>
          </paper-header-panel>

        </div>

        <paper-scroll-header-panel class="main" main fixed>

          <!-- Main Toolbar -->
          <paper-toolbar>
            <paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
          </paper-toolbar>

          <!-- Main Content -->
          <div class="content">
            <iron-pages attr-for-selected="data-route" selected="{{route}}">

              <section data-route = "general" class = 'content-section'>
                <div class="layout vertical center">
                  <paper-card heading = "On Startup" image="images/random-background.svg" animatedShadow>
                    <div class="card-content">
                      <div class="layout horizontal option"><span class = 'flex'>Show edit ribbon on start</span><paper-toggle-button id = "showRibbonOnStart" on-></paper-toggle-button></div>
                      <div class="layout horizontal option"><span class = 'flex'>Enable autorendering</span><paper-toggle-button id = "autorendering"></paper-toggle-button></div>
                      <!-- Need to make settings a separate element to make this easier -->
                      <div class="layout horizontal option"><span class = 'flex'>Show Word Count</span><paper-toggle-button id = "showWordCount"></paper-toggle-button></div>
                    </div>
                  </paper-card>
                </div>
              </section>

              <section data-route = "editor" class = 'content-section'>
                <div class="layout vertical center">
                  <paper-card heading = "Defaults" image="images/random-background.svg" animatedShadow>
                    <div class="card-content">

                    <!-- Default font -->
                      <div class="layout horizontal option"><span class = 'flex'>Default Font</span>
                        <paper-dropdown-menu label = "Primary Color">
                          <paper-menu class="dropdown-content">
                            <template is = "dom-repeat" items = "['Roboto_Mono', 'other']">
                              <paper-item>[[item]]</paper-item>
                            </template>
                          </paper-menu>
                        </paper-dropdown-menu>
                      </div>
                      <!-- Default Fontsize -->
                      <div class="layout horizontal option"><span class = 'flex'>Default Font</span>
                        <paper-dropdown-menu label = "Primary Color">
                          <paper-menu class="dropdown-content">
                            <template is = "dom-repeat" items = "[[fontSizes]]">
                              <paper-item>[[item]]</paper-item>
                            </template>
                          </paper-menu>
                        </paper-dropdown-menu>
                      </div>
                      <!-- Default Editor Theme -->
                      <div class="layout horizontal option"><span class = 'flex'>Default Font</span>
                        <paper-dropdown-menu label = "Primary Color">
                          <paper-menu class="dropdown-content">
                            <template is = "dom-repeat" items = "['Monokai', 'Textmate']">
                              <paper-item>[[item]]</paper-item>
                            </template>
                          </paper-menu>
                        </paper-dropdown-menu>
                      </div>
                    </div>
                  </paper-card>
                  <paper-card heading = "Configurations" image="images/random-background.svg" animatedShadow>
                    <div class="card-content">
                      <div class="layout horizontal option"><span class = 'flex'>Code Folding</span><paper-toggle-button id = "codeFolding"></paper-toggle-button></div>
                      <div class="layout horizontal option"><span class = 'flex'>Show line numbers</span><paper-toggle-button id = "lineNumbers"></paper-toggle-button></div>

                    </div>
                  </paper-card>
                </div>
              </section>

              <section data-route = "markdown" class = 'content-section'>
                <div class="layout vertical center">
                  <paper-card heading = "Extending Rules" image="images/random-background.svg" animatedShadow>
                    <div class="card-content">

                    </div>
                  </paper-card>
                </div>
              </section>

              <section data-route = "theming" class = 'content-section'>
                <div class="layout vertical center">
                  <paper-card heading = "On Startup" image="images/random-background.svg" animatedShadow>
                    <div class="card-content">
                      <div class="layout horizontal option"><span class = 'flex'>Primary Color</span>
                        <paper-dropdown-menu label = "Primary Color">

                          <paper-menu class="dropdown-content">
                            <paper-item style = "color: #303F9F;">Indigo (#303F9F)</paper-item>
                            <paper-item style = "color: #512DA8;">Deep Purple (#512DA8)</paper-item>
                            <paper-item style = "color: #1976D2;">Blue (#1976D2)</paper-item>
                            <paper-item style = "color: #FF5722;">Deep Orange (#FF5722)</paper-item>
                          </paper-menu>

                        </paper-dropdown-menu>
                      </div>
                      <div class="layout horizontal option"><span class = 'flex'>Accent Color</span>

                        <paper-dropdown-menu label = "Accent Color">

                          <paper-menu class="dropdown-content">
                            <paper-item style = "color: #FF4081;">Pink (#FF4081)</paper-item>
                            <paper-item style = "color: #7C4DFF;">Purple (#7C4DFF)</paper-item>
                            <paper-item style = "color: #1976D2;">Blue (#1976D2)</paper-item>
                            <paper-item style = "color: #FFEB3B;">Yellow (#FFEB3B)</paper-item>
                          </paper-menu>

                        </paper-dropdown-menu>
                      </div>
                    </div>
                  </paper-card>
                </div>
              </section>

              <section data-route = "outputStyles" class = 'content-section'>
                <!-- <styles-editor wrap></styles-editor> -->
                <div class="layout vertical center">
                  <paper-card heading = "Active Stylesheet" image="images/random-background.svg" animatedShadow>
                    <div class="card-content">
                      <div class="layout horizontal center option">
                        <span class = 'flex'>Choose a stylesheet</span>
                        <paper-dropdown-menu id = "selectActiveStylesheet" label = "Select Theme">
                          <paper-menu class="dropdown-content">
                            <paper-item>Github</paper-item>
                            <paper-item>Dark Theme</paper-item>
                            <paper-item>Add +</paper-item>
                          </paper-menu>
                        </paper-dropdown-menu>
                      </div>
                    </div>
                  </paper-card>
                </div>
              </section>

            </iron-pages>
          </div>

        </paper-scroll-header-panel>

      </paper-drawer-panel>
  </template>

  <script>
  (function() {
    Polymer({
      is: 'app-settings',

      behaviors: [MarkdownBehaviors.IoBehavior],

      properties: {
        fontSizes: {
          type: Array,
          value: function(){
            var sizes = [];
            for (var i = 10; i < 26; i++){
              sizes.push(i);
            }
            return sizes;
          }
        },
        settings: {
          type: Object
        }
      },

      attached: function(){
        this.readSettings();
      },

      /*
       * Read the settings from settings.json and set the values in the settings window
       */
      readSettings: function(){
        this.settings = require('../settings.json');
        // General settings
        this.$.showRibbonOnStart.checked = this.settings.general.showRibbonOnStart;
        this.$.autorendering.checked = this.settings.general.autorendering;
        this.$.showWordCount.checked = this.settings.general.showWordCount;
        // Editor settings
        this.$.codeFolding.checked = this.settings.editor.codeFolding;
        this.$.lineNumbers.checked = this.settings.editor.lineNumbers;
        // Markdown settings...nothing for now

        // Theming settings

        // Output styles settings
      },

      /*
       * Write the settings to settings.json. Settings are then read in settings-config.js to inject changes into the editor
       */
      writeSettings: function(){
        if (!this.settings){
          console.log("settings object is not defined");
          return;
        }
        // Copy a reference to the settings object
        var tempSettings = this.settings;
        // General settings
        tempSettings.general.showRibbonOnStart = this.$.showRibbonOnStart.checked;
        tempSettings.general.autorendering = this.$.autorendering.checked;
        tempSettings.general.showWordCount = this.$.showWordCount.checked;
        // Editor settings
        tempSettings.editor.codeFolding = this.$.codeFolding.checked;
        tempSettings.editor.lineNumbers = this.$.lineNumbers.checked;
        // Markdown settings...nothing for now

        // Theming settings

        // Output styles settings

        this.fs.writeFileSync(__dirname + '/settings.json', JSON.stringify(tempSettings));
      }

    });
  })();
  </script>
</dom-module>
